<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Sales Ops Analytics</title>
<style>
  /* -------------------------------------------------------
     Design Tokens
  ------------------------------------------------------- */
  :root{
    --bg:#ffffff; --ink:#101418; --muted:#6b7280; --line:#e5e7eb; --panel:#fafafa;
    --brand:#4b7bec; --accent:#f8fafc; --border:#e2e8f0; --glass:rgba(255,255,255,.65);
    --success:#10b981; --warning:#f59e0b; --error:#ef4444;
    --hdr-h:72px;                 /* header height used for no-scroll math */
    --card-pad:18px;              /* base card padding (auto-shrinks) */
    --title-size:28px;            /* base title size (auto-shrinks) */
  }
  [data-theme="dark"]{
    --bg:#0a0e13; --ink:#f5f7fa; --muted:#9ca3af; --line:#1f2937; --panel:#111827;
    --brand:#5b8ef7; --accent:#1a1f2e; --border:#2d3748; --glass:rgba(10,14,19,.85);
    --success:#34d399; --warning:#fbbf24; --error:#f87171;
  }

  /* -------------------------------------------------------
     Base
  ------------------------------------------------------- */
  *{box-sizing:border-box;transition:background-color .25s,color .25s,border-color .25s}
  html,body{margin:0;background:var(--bg);color:var(--ink);
    font:15px/1.4 -apple-system,BlinkMacSystemFont,Inter,'Segoe UI',Roboto,Helvetica,Arial,sans-serif}
  /* no page scroll on desktop; mobile can scroll */
  body{overflow:hidden;}
  @media (max-width:768px){ body{overflow:auto;} }

  .wrap{max-width:1400px;margin:0 auto;padding:16px 24px;width:100%}

  /* -------------------------------------------------------
     Header / Command Bar
  ------------------------------------------------------- */
  .hdr{position:sticky;top:0;z-index:20;backdrop-filter:saturate(180%) blur(8px);
       -webkit-backdrop-filter:saturate(180%) blur(8px);background:var(--glass);
       border-bottom:1px solid var(--line);height:var(--hdr-h);display:flex;align-items:center}
  [data-theme="dark"] .hdr{background:linear-gradient(180deg,rgba(10,14,19,.95),rgba(10,14,19,.9))}
  .hdr-inner{display:flex;gap:18px;align-items:center;justify-content:space-between}

  .logo-container{display:flex;align-items:baseline;gap:12px}
  .logo-text{font-size:24px;font-weight:900;letter-spacing:.085em;font-style:italic}
  .title{font-size:var(--title-size);font-weight:800;line-height:1.1;margin:0 0 6px}
  .subtitle{color:var(--muted);font-size:13px;max-width:960px;line-height:1.35;margin:0}

  /* command bar */
  .cmdbar{display:flex;gap:16px;align-items:center;justify-content:flex-end;min-width:320px}
  .segment{display:inline-flex;border:1px solid var(--border);background:var(--panel);
           border-radius:10px;padding:4px}
  .segment input{display:none}
  .segment label{padding:6px 10px;border-radius:8px;font-size:12px;font-weight:600;
                 cursor:pointer;color:var(--muted);user-select:none}
  .segment input:checked+label{background:var(--accent);color:var(--ink);box-shadow:inset 0 0 0 1px var(--brand)}
  .run-btn{padding:8px 12px;border-radius:10px;border:1px solid var(--border);
           background:var(--ink);color:#fff;font-weight:700;cursor:pointer;transition:all .2s}
  .run-btn:hover:not(:disabled){background:var(--brand);transform:translateY(-1px)}
  .run-btn[disabled]{opacity:.45;cursor:not-allowed}
  .run-btn.loading{position:relative;color:transparent}
  .run-btn.loading::after{content:"";position:absolute;width:16px;height:16px;top:50%;left:50%;
                          margin-left:-8px;margin-top:-8px;border:2px solid white;border-radius:50%;
                          border-top-color:transparent;animation:spin .6s linear infinite}
  @keyframes spin{to{transform:rotate(360deg)}}

  /* powered by */
  .pb{display:flex;gap:8px;align-items:center}
  .pb .badge{width:26px;height:26px;border:1px solid var(--border);border-radius:6px;
             display:flex;align-items:center;justify-content:center;background:#fff;transition:.2s;cursor:pointer}
  .pb .badge svg{width:16px;height:16px;opacity:.85}
  .pb .badge:hover{transform:translateY(-1px);border-color:var(--brand)}
  .pb .badge:hover svg{opacity:1}
  [data-theme="dark"] .pb .badge{background:var(--panel)}

  /* theme toggle */
  .theme-toggle{flex-shrink:0;width:44px;height:44px;border-radius:12px;border:1px solid var(--border);
                background:var(--panel);display:flex;align-items:center;justify-content:center;cursor:pointer;position:relative}
  .theme-toggle-icon{width:20px;height:20px;position:absolute}
  .theme-toggle .moon{opacity:0}
  [data-theme="dark"] .theme-toggle .sun{opacity:0}
  [data-theme="dark"] .theme-toggle .moon{opacity:1}

  /* -------------------------------------------------------
     Logo SVG (exact brand feel)
  ------------------------------------------------------- */
  .logo-symbol{width:48px;height:48px; color:var(--ink)}
  [data-theme="dark"] .logo-symbol{color:var(--ink)}
  /* keep stroke weight identical at any size */
  .logo-symbol *{vector-effect:non-scaling-stroke}

  /* -------------------------------------------------------
     Tabs + No-Scroll Viewport
  ------------------------------------------------------- */
  .viewport{height:calc(100vh - var(--hdr-h) - 12px);display:flex;flex-direction:column}
  .tabs{display:flex;gap:8px;margin:8px 0 12px}
  .tab{padding:8px 12px;border:1px solid var(--border);border-radius:999px;font-weight:700;
       font-size:12px;color:var(--muted);cursor:pointer;background:var(--panel)}
  .tab.active{color:var(--ink);background:var(--accent);border-color:var(--brand)}
  .tabpanel{flex:1;display:grid;grid-template-columns:repeat(3,1fr);gap:16px;align-content:start;overflow-y:auto}
  @media (max-width:1200px){ .tabpanel{grid-template-columns:repeat(2,1fr)} }
  @media (max-width:768px){ .viewport{height:auto} .tabpanel{grid-template-columns:1fr} }

  /* -------------------------------------------------------
     Cards (auto-shrink + truncation)
  ------------------------------------------------------- */
  .dashboard-card{background:var(--panel);border:1px solid var(--border);border-radius:12px;
                  padding:var(--card-pad);box-shadow:0 1px 3px rgba(0,0,0,.05),0 1px 2px rgba(0,0,0,.08);
                  transition:transform .2s,box-shadow .2s;border-color:var(--border);
                  color:inherit;text-decoration:none;display:block}
  .dashboard-card:hover{transform:translateY(-2px);box-shadow:0 4px 12px rgba(0,0,0,.1),0 2px 4px rgba(0,0,0,.08);border-color:var(--brand)}
  .card-icon{font-size:28px;margin-bottom:8px}
  .card-title{font-size:16px;font-weight:800;margin:0 0 6px}
  .card-description{font-size:12px;color:var(--muted);line-height:1.45;margin:0 0 8px;
                    display:-webkit-box;-webkit-line-clamp:2;line-clamp:2;-webkit-box-orient:vertical;overflow:hidden}
  .card-meta{display:flex;gap:10px;align-items:center;flex-wrap:wrap;padding-top:8px;border-top:1px solid var(--line)}
  .meta-item{display:flex;align-items:center;gap:5px;font-size:11px;color:var(--muted)}
  .status-badge{display:inline-flex;align-items:center;gap:4px;padding:3px 8px;border-radius:999px;
                background:var(--accent);border:1px solid var(--border);font-size:10px;font-weight:700;color:var(--success)}
  .status-badge::before{content:"‚úì";display:inline-block;width:10px;height:10px;border-radius:50%;background:var(--success);
                        color:#fff;text-align:center;line-height:10px;font-size:7px}

  /* Footer inside viewport so it never forces page scroll */
  .footer{display:flex;justify-content:space-between;align-items:center;margin-top:12px;
          padding-top:10px;border-top:1px solid var(--line);color:var(--muted);font-size:11px}
  .brandmark{font-weight:900;letter-spacing:.08em}

  /* Status message */
  .status-message{margin-top:8px;padding:6px 10px;border-radius:6px;font-size:11px;font-weight:500;display:none}
  .status-message.success{background:rgba(16,185,129,.1);color:var(--success);border:1px solid rgba(16,185,129,.2);display:block}
  .status-message.error{background:rgba(239,68,68,.1);color:var(--error);border:1px solid rgba(239,68,68,.2);display:block}
  .status-message.info{background:rgba(75,123,236,.1);color:var(--brand);border:1px solid rgba(75,123,236,.2);display:block}

  /* -------------------------------------------------------
     Auto-shrink rules for 13-inch laptops (common 1280‚Äì1440 wide, ~800 high)
     - tighter paddings
     - smaller title
     - keep no-scroll
  ------------------------------------------------------- */
  @media (max-height:820px){
    :root{ --card-pad:14px; --title-size:24px; }
    .subtitle{font-size:12px}
    .tabpanel{gap:14px}
  }
  @media (max-height:760px){
    :root{ --card-pad:12px; --title-size:22px; }
    .card-description{ -webkit-line-clamp:2; line-clamp:2; }     /* already 2 lines, keep tight */
    .footer{margin-top:8px;padding-top:8px}
  }

  /* Mobile header compaction */
  @media (max-width:768px){
    .wrap{padding:12px 16px}
    .hdr-inner{gap:12px;flex-wrap:wrap}
    .logo-text{font-size:18px}
    .title{font-size:20px;font-weight:700;margin:0}
    .subtitle{font-size:11px}
    .cmdbar{flex-direction:column;align-items:stretch;gap:10px;min-width:0}
    .hdr{height:auto;padding:8px 0}
  }
</style>
</head>
<body>

  <!-- Header -->
  <div class="hdr">
    <div class="wrap hdr-inner">
      <!-- Logo + Title -->
      <div class="logo-container">
        <!-- Brand mark (interlocking frames) -->
        <svg class="logo-symbol" viewBox="0 0 260 220" xmlns="http://www.w3.org/2000/svg"
             fill="none" stroke="currentColor" stroke-width="18" stroke-linecap="butt"
             stroke-linejoin="miter" stroke-miterlimit="10" aria-hidden="true">
          <!-- Left frame (behind) -->
          <path d="M22 150 L86 32 L176 12 L112 130 Z"/>
          <path d="M57 144 L111 44 C118 31 135 28 147 33 L95 132"/>
          <!-- Right frame (front) -->
          <path d="M84 170 L148 52 L238 32 L174 150 Z"/>
          <path d="M120 164 L172 64 C179 51 196 48 208 53 L156 152"/>
        </svg>
        <span class="logo-text">INNOVATIVE</span>
      </div>

      <!-- Title group -->
      <div class="hdr-title-group" style="flex:1;min-width:0">
        <div class="title">Sales Ops Analytics</div>
        <div class="subtitle">Select a dashboard below to view detailed metrics and insights.</div>
      </div>

      <!-- Command bar: Actions + Run + Powered By -->
      <div class="cmdbar">
        <!-- Segmented actions -->
        <div class="segment" id="actionSeg">
          <input id="a1" name="action" type="radio" value="refresh-snapshot" checked><label for="a1">Snapshot</label>
          <input id="a2" name="action" type="radio" value="refresh-trailing"><label for="a2">6-Week</label>
          <input id="a3" name="action" type="radio" value="slack-aston"><label for="a3">Slack Aston</label>
          <input id="a4" name="action" type="radio" value="slack-jean"><label for="a4">Slack Jean</label>
        </div>

        <button class="run-btn" id="executeButton">Run</button>

        <!-- Powered by (quiet) -->
        <div class="pb" aria-label="Powered by">
          <a href="https://www.salesforce.com" target="_blank" class="badge" title="Salesforce">
            <svg viewBox="0 0 24 24" fill="#00A1E0"><circle cx="12" cy="12" r="9"/></svg>
          </a>
          <a href="https://www.python.org" target="_blank" class="badge" title="Python">
            <svg viewBox="0 0 24 24" fill="#3776AB"><circle cx="9" cy="9" r="4"/><circle cx="15" cy="15" r="4"/></svg>
          </a>
          <a href="https://cursor.sh" target="_blank" class="badge" title="Cursor">
            <svg viewBox="0 0 24 24"><path d="M5 4l14 8-14 8 4-8z" fill="currentColor"/></svg>
          </a>
          <a href="https://github.com" target="_blank" class="badge" title="GitHub">
            <svg viewBox="0 0 24 24" fill="#181717"><path d="M12 2a10 10 0 0 0-3.16 19.49v-2.9c-1.1.24-1.33-.5-1.33-.5-.2-.52-.48-.65-.48-.65-.4-.27.03-.27.03-.27.45.03.69.47.69.47.4.7 1.05.5 1.3.38.04-.3.16-.5.28-.62-2.66-.3-5.46-1.33-5.46-5.9 0-1.3.47-2.36 1.24-3.18-.12-.3-.54-1.5.12-3.14 0 0 1.01-.32 3.3 1.22a11.5 11.5 0 0 1 6 0c2.3-1.54 3.3-1.22 3.3-1.22.66 1.64.24 2.84.12 3.14.77.82 1.24 1.88 1.24 3.18 0 4.6-2.8 5.6-5.47 5.9.17.15.33.45.33.92v3.43A10 10 0 0 0 12 2z"/></svg>
          </a>
        </div>

        <!-- Theme toggle -->
        <button class="theme-toggle" id="themeToggle" aria-label="Toggle dark/light theme">
          <svg class="theme-toggle-icon sun" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <circle cx="12" cy="12" r="5"></circle>
            <line x1="12" y1="1" x2="12" y2="3"></line><line x1="12" y1="21" x2="12" y2="23"></line>
            <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
            <line x1="1" y1="12" x2="3" y2="12"></line><line x1="21" y1="12" x2="23" y2="12"></line>
            <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
          </svg>
          <svg class="theme-toggle-icon moon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
          </svg>
        </button>
      </div>
    </div>
  </div>

  <!-- Viewport (no-scroll) -->
  <div class="wrap viewport">
    <!-- Tabs -->
    <div class="tabs" role="tablist">
      <button class="tab active" data-tab="exec" role="tab" aria-selected="true">Executive</button>
      <button class="tab" data-tab="velocity" role="tab" aria-selected="false">Velocity</button>
      <button class="tab" data-tab="featured" role="tab" aria-selected="false">Featured</button>
    </div>

    <!-- EXEC -->
    <div class="tabpanel" id="tab-exec" role="tabpanel">
      <a href="exec_pipeline_dashboard - PoC.html" class="dashboard-card">
        <div class="card-icon">üéØ</div>
        <div class="card-title">Executive Pipeline Dashboard</div>
        <p class="card-description">Comprehensive executive-level pipeline analysis combining data from multiple sources. Includes high-level metrics, elite pipeline analysis, and strategic insights.</p>
        <div class="card-meta"><span class="status-badge">Active</span></div>
      </a>
      <!-- empty cells keep the row balanced without forcing scroll -->
      <div></div><div></div>
    </div>

    <!-- VELOCITY -->
    <div class="tabpanel" id="tab-velocity" role="tabpanel" hidden>
      <a href="boca_velocity_latest.html" class="dashboard-card">
        <div class="card-icon">üìä</div>
        <div class="card-title">Boca Sales Velocity</div>
        <p class="card-description">DGR Sales Velocity report tracking meetings, opportunity dollars, and closed won metrics by rep. Includes week-over-week comparisons and 6-week trailing averages.</p>
        <div class="card-meta"><span class="status-badge">Active</span></div>
      </a>

      <a href="pipeline_velocity_latest.html" class="dashboard-card">
        <div class="card-icon">‚ö°</div>
        <div class="card-title">Pipeline Velocity</div>
        <p class="card-description">Comprehensive pipeline velocity analysis tracking pipeline creation, accounts owned, open opportunities, win rates, and average deal metrics by rep.</p>
        <div class="card-meta"><span class="status-badge">Active</span></div>
      </a>
      <div></div>
    </div>

    <!-- FEATURED -->
    <div class="tabpanel" id="tab-featured" role="tabpanel" hidden>
      <a href="flow_slack_metrics_ghost_pipeline_latest.html" class="dashboard-card">
        <div class="card-icon">üëª</div>
        <div class="card-title">Ghost Pipeline</div>
        <p class="card-description">Track opportunities in the pipeline with extended periods without activity. Monitor alerts sent, response times, and closed-out value to identify and address stalled deals.</p>
        <div class="card-meta">
          <div class="meta-item">Flow ID: 301PQ00000iX6QRYA0</div>
          <span class="status-badge">Active</span>
        </div>
      </a>

      <a href="flow_slack_metrics_past_due_closed_date_latest.html" class="dashboard-card">
        <div class="card-icon">üìÖ</div>
        <div class="card-title">Past Due Closed Date</div>
        <p class="card-description">Monitor opportunities with past due close dates. Track compliance metrics, alert frequency, and response times to ensure timely deal closure.</p>
        <div class="card-meta">
          <div class="meta-item">Flow ID: 301PQ00000iMEFuYAO</div>
          <span class="status-badge">Active</span>
        </div>
      </a>

      <a href="touchpoint_intelligence_latest.html" class="dashboard-card">
        <div class="card-icon">üîç</div>
        <div class="card-title">Touchpoint Intelligence Report</div>
        <p class="card-description">Highlights high-signal accounts (multiple active touchpoints + recent engagement) before opportunities are created. Early-signal detection for proactive pipeline creation.</p>
        <div class="card-meta"><span class="status-badge">Active</span></div>
      </a>
    </div>

    <!-- Footer inside viewport -->
    <div class="footer">
      <div id="runStatus">Ready</div>
      <div class="brandmark">INNOVATIVE ‚Ä¢ SALES OPS</div>
    </div>
  </div>

<script>
  /* ----------------- Configuration ----------------- */
  const CONFIG = {
    endpoints: {
      'refresh-snapshot': '/api/refresh-snapshot',
      'refresh-trailing': '/api/refresh-trailing',
      'slack-aston': '/api/slack-aston',
      'slack-jean': '/api/slack-jean'
    },
    slack: {
      aston: '', // Webhook URL: https://hooks.slack.com/services/YOUR/WEBHOOK/URL
      jean: '',  // Webhook URL: https://hooks.slack.com/services/YOUR/WEBHOOK/URL
      useApi: false,
      botToken: '',  // Slack Bot User OAuth Token (starts with xoxb-)
      userIds: {
        aston: 'U099KHE7XL6',
        jean: 'U073MA5C4MN'
      }
    }
  };

  /* ----------------- Theme ----------------- */
  (function(){
    const themeToggle=document.getElementById('themeToggle');
    const html=document.documentElement;
    const saved=localStorage.getItem('theme')||'light';
    const prefersDark=window.matchMedia('(prefers-color-scheme: dark)').matches;
    const initial=saved==='auto'?(prefersDark?'dark':'light'):saved;
    if(initial==='dark') html.setAttribute('data-theme','dark');
    themeToggle?.addEventListener('click',()=>{
      const dark=html.getAttribute('data-theme')==='dark';
      if(dark){ html.removeAttribute('data-theme'); localStorage.setItem('theme','light'); }
      else{ html.setAttribute('data-theme','dark'); localStorage.setItem('theme','dark'); }
    });
  })();

  /* ----------------- Tabs ----------------- */
  const tabs=document.querySelectorAll('.tab');
  const panes={
    exec:document.getElementById('tab-exec'),
    velocity:document.getElementById('tab-velocity'),
    featured:document.getElementById('tab-featured'),
  };
  tabs.forEach(t=>{
    t.addEventListener('click',()=>{
      tabs.forEach(x=>{x.classList.remove('active');x.setAttribute('aria-selected','false');});
      Object.values(panes).forEach(p=>p.hidden=true);
      t.classList.add('active');t.setAttribute('aria-selected','true');
      panes[t.dataset.tab].hidden=false;
    });
  });

  /* ----------------- Actions ----------------- */
  const executeButton=document.getElementById('executeButton');
  const runStatus=document.getElementById('runStatus');

  function selectedAction(){ return document.querySelector('input[name="action"]:checked').value; }

  async function triggerRefresh(scriptName, action) {
    const endpoint = CONFIG.endpoints[action];
    if (endpoint && endpoint.startsWith('/api/')) {
      try {
        const response = await fetch(endpoint, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' }
        });
        if (!response.ok) throw new Error(`HTTP ${response.status}`);
        return { success: true, message: `${scriptName} refresh initiated!` };
      } catch (error) {
        return { success: false, message: `API endpoint not configured. For local execution: python3 "${scriptName === 'Snapshot Summary' ? 'SnapshotSummary.py' : 'trailingProfServ.py'}"` };
      }
    }
    return { success: false, message: `To run locally: python3 "${scriptName === 'Snapshot Summary' ? 'SnapshotSummary.py' : 'trailingProfServ.py'}"` };
  }

  async function sendSlackMessage(recipient, webhookUrl) {
    const recipientLower = recipient.toLowerCase();
    if (CONFIG.slack.useApi && CONFIG.slack.botToken && CONFIG.slack.userIds[recipientLower]) {
      return await sendSlackDM(recipient, CONFIG.slack.userIds[recipientLower]);
    }
    if (!webhookUrl || webhookUrl === '') {
      return { success: false, message: `Slack not configured for ${recipient}. Add webhook URL or set useApi=true with botToken.` };
    }
    try {
      const response = await fetch(webhookUrl, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({
          text: `Sales Ops Dashboard refresh requested for ${recipient}`,
          username: 'Sales Ops Bot',
          icon_emoji: ':chart_with_upwards_trend:'
        })
      });
      if (!response.ok) throw new Error(`HTTP ${response.status}`);
      return { success: true, message: `Slack message sent to ${recipient}!` };
    } catch (error) {
      return { success: false, message: `Failed to send Slack message: ${error.message}` };
    }
  }

  async function sendSlackDM(recipient, userId) {
    if (!CONFIG.slack.botToken || !userId) {
      return { success: false, message: `Slack API not configured. Need botToken and userIds.${recipient.toLowerCase()}` };
    }
    try {
      const response = await fetch('/api/slack-dm', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({
          token: CONFIG.slack.botToken,
          userId: userId,
          message: `Sales Ops Dashboard refresh requested for ${recipient}`
        })
      });
      if (!response.ok) throw new Error(`HTTP ${response.status}`);
      return { success: true, message: `Direct message sent to ${recipient}!` };
    } catch (error) {
      return { success: false, message: `Slack API requires a backend endpoint. Create /api/slack-dm that calls Slack's chat.postMessage API. User ID: ${userId}` };
    }
  }

  async function executeAction() {
    const action = selectedAction();
    const button = executeButton;
    button.disabled = true;
    button.classList.add('loading');
    button.textContent = 'Running‚Ä¶';
    runStatus.textContent = `Running: ${action}‚Ä¶`;

    try {
      let result;
      switch(action) {
        case 'refresh-snapshot':
          result = await triggerRefresh('Snapshot Summary', action);
          break;
        case 'refresh-trailing':
          result = await triggerRefresh('6 Week Trailing Report', action);
          break;
        case 'slack-aston':
          result = await sendSlackMessage('Aston', CONFIG.slack.aston);
          break;
        case 'slack-jean':
          result = await sendSlackMessage('Jean', CONFIG.slack.jean);
          break;
        default:
          throw new Error('Unknown action');
      }

      if (result.success) {
        runStatus.textContent = `‚úì ${result.message || 'Completed successfully!'}`;
        runStatus.style.color = 'var(--success)';
      } else {
        runStatus.textContent = `‚úó ${result.message || 'Action failed'}`;
        runStatus.style.color = 'var(--error)';
      }
    } catch (error) {
      runStatus.textContent = `‚úó Error: ${error.message || 'Failed to execute'}`;
      runStatus.style.color = 'var(--error)';
    } finally {
      button.disabled = false;
      button.classList.remove('loading');
      button.textContent = 'Run';
      setTimeout(() => {
        runStatus.textContent = 'Ready';
        runStatus.style.color = 'var(--muted)';
      }, 5000);
    }
  }

  executeButton.addEventListener('click', executeAction);
</script>
</body>
</html>
