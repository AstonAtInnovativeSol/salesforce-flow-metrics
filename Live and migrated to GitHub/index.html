<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Sales Ops Analytics</title>
<style>
  /* -------------------------------------------------------
     Design Tokens
  ------------------------------------------------------- */
  :root{
    --bg:#ffffff; --ink:#1d1d1f; --muted:#86868b; --line:#d2d2d7; --panel:#f5f5f7;
    --brand:#007aff; --accent:#f5f5f7; --border:#e5e5ea; --glass:rgba(255,255,255,.8);
    --success:#34c759; --warning:#ff9500; --error:#ff3b30;
    --hdr-h:88px;                 /* generous header height for premium feel */
    --card-pad:20px;              /* generous card padding */
    --title-size:32px;            /* prominent title size */
    --spacing-xs:4px; --spacing-sm:8px; --spacing-md:16px; --spacing-lg:24px; --spacing-xl:32px;
  }
  [data-theme="dark"]{
    --bg:#000000; --ink:#f5f5f7; --muted:#86868b; --line:#1d1d1f; --panel:#1c1c1e;
    --brand:#0a84ff; --accent:#1c1c1e; --border:#2c2c2e; --glass:rgba(0,0,0,.8);
    --success:#30d158; --warning:#ff9f0a; --error:#ff453a;
  }

  /* -------------------------------------------------------
     Base - Apple SF Pro Typography
  ------------------------------------------------------- */
  *{box-sizing:border-box;transition:background-color .25s cubic-bezier(.4,0,.2,1),
    color .25s cubic-bezier(.4,0,.2,1),border-color .25s cubic-bezier(.4,0,.2,1),
    transform .25s cubic-bezier(.4,0,.2,1),box-shadow .25s cubic-bezier(.4,0,.2,1)}
  html,body{margin:0;background:var(--bg);color:var(--ink);
    font:-apple-system,BlinkMacSystemFont,'SF Pro Display','SF Pro Text','Helvetica Neue',Helvetica,Arial,sans-serif;
    font-size:15px;line-height:1.46667;font-weight:400;-webkit-font-smoothing:antialiased;
    -moz-osx-font-smoothing:grayscale}
  body{overflow:hidden;}
  @media (max-width:768px){ body{overflow:auto;} }

  .wrap{max-width:1440px;margin:0 auto;padding:var(--spacing-lg) var(--spacing-xl);width:100%}

  /* -------------------------------------------------------
     Header / Command Bar - Premium Spacing
  ------------------------------------------------------- */
  .hdr{position:sticky;top:0;z-index:100;backdrop-filter:saturate(180%) blur(20px);
       -webkit-backdrop-filter:saturate(180%) blur(20px);background:var(--glass);
       border-bottom:0.5px solid var(--line);height:var(--hdr-h);display:flex;align-items:center;
       box-shadow:0 1px 0 rgba(0,0,0,.04)}
  [data-theme="dark"] .hdr{background:rgba(0,0,0,.8);border-bottom-color:rgba(255,255,255,.1)}
  .hdr-inner{display:flex;gap:var(--spacing-xl);align-items:center;justify-content:space-between;width:100%}

  .logo-container{display:flex;align-items:center;gap:var(--spacing-lg);flex-shrink:0}
  .logo-img{height:64px;width:auto;object-fit:contain;display:block}
  .hdr-title-group{flex:1;min-width:0;padding-right:var(--spacing-xl);padding-left:var(--spacing-md)}
  .title{font-size:36px;font-weight:700;line-height:1.1;margin:0 0 var(--spacing-md);
    letter-spacing:-.02em;color:var(--ink)}
  .subtitle{color:var(--muted);font-size:15px;max-width:700px;line-height:1.46667;margin:0;
    font-weight:400}

  /* command bar - Refined Apple-style controls */
  .cmdbar{display:flex;gap:var(--spacing-md);align-items:center;justify-content:flex-end;
          flex-shrink:0;min-width:420px}
  .segment{display:inline-flex;border:0.5px solid var(--border);background:var(--panel);
           border-radius:12px;padding:var(--spacing-xs);gap:var(--spacing-xs);
           box-shadow:0 1px 3px rgba(0,0,0,.04)}
  .segment input{display:none}
  .segment label{padding:var(--spacing-sm) var(--spacing-md);border-radius:8px;
                 font-size:13px;font-weight:600;cursor:pointer;color:var(--muted);
                 user-select:none;transition:all .15s cubic-bezier(.4,0,.2,1)}
  .segment label:hover{background:var(--accent)}
  .segment input:checked+label{background:var(--brand);color:#fff;box-shadow:0 1px 3px rgba(0,0,0,.12)}
  .run-btn{padding:var(--spacing-sm) var(--spacing-lg);border-radius:10px;border:none;
           background:var(--ink);color:#fff;font-weight:600;font-size:13px;cursor:pointer;
           transition:all .2s cubic-bezier(.4,0,.2,1);box-shadow:0 1px 3px rgba(0,0,0,.1);
           min-width:72px}
  .run-btn:hover:not(:disabled){background:var(--brand);transform:translateY(-0.5px);
                                box-shadow:0 2px 8px rgba(0,122,255,.3)}
  .run-btn:active:not(:disabled){transform:translateY(0);box-shadow:0 1px 2px rgba(0,0,0,.1)}
  .run-btn[disabled]{opacity:.4;cursor:not-allowed;transform:none}
  .run-btn.loading{position:relative;color:transparent}
  .run-btn.loading::after{content:"";position:absolute;width:14px;height:14px;top:50%;left:50%;
                          margin-left:-7px;margin-top:-7px;border:2px solid rgba(255,255,255,.3);
                          border-radius:50%;border-top-color:white;animation:spin .6s linear infinite}
  @keyframes spin{to{transform:rotate(360deg)}}

  /* powered by - Subtle badges */
  .pb{display:flex;gap:var(--spacing-sm);align-items:center}
  .pb .badge{width:28px;height:28px;border:0.5px solid var(--border);border-radius:8px;
             display:flex;align-items:center;justify-content:center;background:var(--panel);
             transition:all .2s cubic-bezier(.4,0,.2,1);cursor:pointer;text-decoration:none}
  .pb .badge svg{width:16px;height:16px;opacity:.7;transition:opacity .2s}
  .pb .badge:hover{transform:translateY(-1px);border-color:var(--brand);
                   box-shadow:0 2px 8px rgba(0,0,0,.08);background:var(--bg)}
  .pb .badge:hover svg{opacity:1}
  [data-theme="dark"] .pb .badge{background:var(--panel)}

  /* theme toggle - Refined */
  .theme-toggle{flex-shrink:0;width:36px;height:36px;border-radius:10px;border:0.5px solid var(--border);
                background:var(--panel);display:flex;align-items:center;justify-content:center;
                cursor:pointer;position:relative;transition:all .2s cubic-bezier(.4,0,.2,1)}
  .theme-toggle:hover{background:var(--accent);border-color:var(--brand)}
  .theme-toggle-icon{width:18px;height:18px;position:absolute;transition:opacity .2s,transform .2s}
  .theme-toggle .moon{opacity:0;transform:rotate(-90deg)}
  [data-theme="dark"] .theme-toggle .sun{opacity:0;transform:rotate(90deg)}
  [data-theme="dark"] .theme-toggle .moon{opacity:1;transform:rotate(0deg)}


  /* -------------------------------------------------------
     Dashboard Grid - No tabs, all visible
  ------------------------------------------------------- */
  .viewport{height:calc(100vh - var(--hdr-h) - var(--spacing-md));display:flex;flex-direction:column}
  .dashboard-grid{flex:1;display:grid;grid-template-columns:repeat(3,1fr);gap:var(--spacing-lg);
                  align-content:start;overflow-y:auto;padding:var(--spacing-lg) 0;
                  margin-top:var(--spacing-md)}
  @media (max-width:1200px){ .dashboard-grid{grid-template-columns:repeat(2,1fr)} }
  @media (max-width:768px){ .viewport{height:auto} .dashboard-grid{grid-template-columns:1fr;gap:var(--spacing-md)} }

  /* -------------------------------------------------------
     Cards - Apple-level polish
  ------------------------------------------------------- */
  .dashboard-card{background:var(--panel);border:0.5px solid var(--border);border-radius:16px;
                  padding:var(--card-pad);box-shadow:0 1px 3px rgba(0,0,0,.04),0 0 0 0.5px rgba(0,0,0,.02);
                  transition:all .3s cubic-bezier(.4,0,.2,1);border-color:var(--border);
                  color:inherit;text-decoration:none;display:block;position:relative;overflow:hidden}
  .dashboard-card::before{content:"";position:absolute;top:0;left:0;right:0;height:2px;
                         background:linear-gradient(90deg,var(--brand),transparent);
                         opacity:0;transition:opacity .3s}
  .dashboard-card:hover{transform:translateY(-4px) scale(1.01);
                        box-shadow:0 8px 24px rgba(0,0,0,.12),0 2px 8px rgba(0,0,0,.08);
                        border-color:var(--brand)}
  .dashboard-card:hover::before{opacity:1}
  .card-icon{font-size:32px;margin-bottom:var(--spacing-md);line-height:1}
  .card-title{font-size:17px;font-weight:600;margin:0 0 var(--spacing-sm);
              letter-spacing:-.01em;color:var(--ink);line-height:1.3}
  .card-description{font-size:13px;color:var(--muted);line-height:1.46154;margin:0 0 var(--spacing-md);
                    display:-webkit-box;-webkit-line-clamp:2;line-clamp:2;
                    -webkit-box-orient:vertical;overflow:hidden;font-weight:400}
  .card-meta{display:flex;gap:var(--spacing-md);align-items:center;flex-wrap:wrap;
            padding-top:var(--spacing-md);border-top:0.5px solid var(--line);margin-top:var(--spacing-sm)}
  .meta-item{display:flex;align-items:center;gap:var(--spacing-xs);font-size:11px;color:var(--muted);
            font-weight:500}
  .status-badge{display:inline-flex;align-items:center;gap:var(--spacing-xs);padding:4px 10px;
                border-radius:999px;background:rgba(52,199,89,.1);border:0.5px solid rgba(52,199,89,.2);
                font-size:11px;font-weight:600;color:var(--success)}
  .status-badge::before{content:"‚úì";display:inline-block;width:12px;height:12px;border-radius:50%;
                        background:var(--success);color:#fff;text-align:center;line-height:12px;
                        font-size:8px;font-weight:700}

  /* Footer inside viewport so it never forces page scroll */
  .footer{display:flex;justify-content:space-between;align-items:center;margin-top:var(--spacing-lg);
          padding-top:var(--spacing-md);border-top:0.5px solid var(--line);color:var(--muted);
          font-size:12px;font-weight:500}
  .brandmark{font-weight:700;letter-spacing:.05em;color:var(--muted)}

  /* Status message */
  .status-message{margin-top:8px;padding:6px 10px;border-radius:6px;font-size:11px;font-weight:500;display:none}
  .status-message.success{background:rgba(16,185,129,.1);color:var(--success);border:1px solid rgba(16,185,129,.2);display:block}
  .status-message.error{background:rgba(239,68,68,.1);color:var(--error);border:1px solid rgba(239,68,68,.2);display:block}
  .status-message.info{background:rgba(75,123,236,.1);color:var(--brand);border:1px solid rgba(75,123,236,.2);display:block}

  /* -------------------------------------------------------
     Auto-shrink rules for 13-inch laptops (common 1280‚Äì1440 wide, ~800 high)
     - tighter paddings
     - smaller title
     - keep no-scroll
  ------------------------------------------------------- */
  @media (max-height:820px){
    :root{ --card-pad:14px; }
    .title{font-size:32px}
    .subtitle{font-size:13px}
    .dashboard-grid{gap:14px}
  }
  @media (max-height:760px){
    :root{ --card-pad:12px; }
    .title{font-size:28px}
    .card-description{ -webkit-line-clamp:2; line-clamp:2; }
    .footer{margin-top:8px;padding-top:8px}
  }

  /* Mobile header compaction */
  @media (max-width:768px){
    .wrap{padding:var(--spacing-md) var(--spacing-lg)}
    .hdr-inner{gap:var(--spacing-md);flex-wrap:wrap}
    .logo-img{height:48px}
    .title{font-size:28px;font-weight:700;margin:0}
    .subtitle{font-size:12px}
    .cmdbar{flex-direction:column;align-items:stretch;gap:var(--spacing-md);min-width:0}
    .hdr{height:auto;min-height:var(--hdr-h);padding:var(--spacing-md) 0}
    .hdr-title-group{padding-right:0}
  }
</style>
</head>
<body>

  <!-- Header -->
  <div class="hdr">
    <div class="wrap hdr-inner">
      <!-- Logo + Title -->
      <div class="logo-container">
        <img src="innovLogo-black.png" alt="INNOVATIVE" class="logo-img" />
      </div>

      <!-- Title group -->
      <div class="hdr-title-group">
        <div class="title">Sales Ops Analytics</div>
        <div class="subtitle">Select a dashboard below to view detailed metrics and insights.</div>
      </div>

      <!-- Command bar: Actions + Run + Powered By -->
      <div class="cmdbar">
        <!-- Segmented actions -->
        <div class="segment" id="actionSeg">
          <input id="a1" name="action" type="radio" value="refresh-snapshot" checked><label for="a1">Snapshot</label>
          <input id="a2" name="action" type="radio" value="refresh-trailing"><label for="a2">6-Week</label>
          <input id="a3" name="action" type="radio" value="slack-aston"><label for="a3">Slack Aston</label>
          <input id="a4" name="action" type="radio" value="slack-jean"><label for="a4">Slack Jean</label>
        </div>

        <button class="run-btn" id="executeButton">Run</button>

        <!-- Powered by (quiet) -->
        <div class="pb" aria-label="Powered by">
          <a href="https://www.salesforce.com" target="_blank" class="badge" title="Salesforce">
            <svg viewBox="0 0 24 24" fill="#00A1E0"><circle cx="12" cy="12" r="9"/></svg>
          </a>
          <a href="https://www.python.org" target="_blank" class="badge" title="Python">
            <svg viewBox="0 0 24 24" fill="#3776AB"><circle cx="9" cy="9" r="4"/><circle cx="15" cy="15" r="4"/></svg>
          </a>
          <a href="https://cursor.sh" target="_blank" class="badge" title="Cursor">
            <svg viewBox="0 0 24 24"><path d="M5 4l14 8-14 8 4-8z" fill="currentColor"/></svg>
          </a>
          <a href="https://github.com" target="_blank" class="badge" title="GitHub">
            <svg viewBox="0 0 24 24" fill="#181717"><path d="M12 2a10 10 0 0 0-3.16 19.49v-2.9c-1.1.24-1.33-.5-1.33-.5-.2-.52-.48-.65-.48-.65-.4-.27.03-.27.03-.27.45.03.69.47.69.47.4.7 1.05.5 1.3.38.04-.3.16-.5.28-.62-2.66-.3-5.46-1.33-5.46-5.9 0-1.3.47-2.36 1.24-3.18-.12-.3-.54-1.5.12-3.14 0 0 1.01-.32 3.3 1.22a11.5 11.5 0 0 1 6 0c2.3-1.54 3.3-1.22 3.3-1.22.66 1.64.24 2.84.12 3.14.77.82 1.24 1.88 1.24 3.18 0 4.6-2.8 5.6-5.47 5.9.17.15.33.45.33.92v3.43A10 10 0 0 0 12 2z"/></svg>
          </a>
        </div>

        <!-- Theme toggle -->
        <button class="theme-toggle" id="themeToggle" aria-label="Toggle dark/light theme">
          <svg class="theme-toggle-icon sun" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <circle cx="12" cy="12" r="5"></circle>
            <line x1="12" y1="1" x2="12" y2="3"></line><line x1="12" y1="21" x2="12" y2="23"></line>
            <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
            <line x1="1" y1="12" x2="3" y2="12"></line><line x1="21" y1="12" x2="23" y2="12"></line>
            <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
          </svg>
          <svg class="theme-toggle-icon moon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
          </svg>
        </button>
      </div>
    </div>
  </div>

  <!-- Viewport (no-scroll) -->
  <div class="wrap viewport">
    <!-- All Dashboards in One Grid -->
    <div class="dashboard-grid">
      <!-- Executive -->
      <a href="exec_pipeline_dashboard - PoC.html" class="dashboard-card">
        <div class="card-icon">üéØ</div>
        <div class="card-title">Executive Pipeline Dashboard</div>
        <p class="card-description">Comprehensive executive-level pipeline analysis combining data from multiple sources. Includes high-level metrics, elite pipeline analysis, and strategic insights.</p>
        <div class="card-meta"><span class="status-badge">Active</span></div>
      </a>

      <!-- Velocity -->
      <a href="boca_velocity_latest.html" class="dashboard-card">
        <div class="card-icon">üìä</div>
        <div class="card-title">Boca Sales Velocity</div>
        <p class="card-description">DGR Sales Velocity report tracking meetings, opportunity dollars, and closed won metrics by rep. Includes week-over-week comparisons and 6-week trailing averages.</p>
        <div class="card-meta"><span class="status-badge">Active</span></div>
      </a>

      <a href="pipeline_velocity_latest.html" class="dashboard-card">
        <div class="card-icon">‚ö°</div>
        <div class="card-title">Pipeline Velocity</div>
        <p class="card-description">Comprehensive pipeline velocity analysis tracking pipeline creation, accounts owned, open opportunities, win rates, and average deal metrics by rep.</p>
        <div class="card-meta"><span class="status-badge">Active</span></div>
      </a>

      <!-- Featured -->
      <a href="flow_slack_metrics_ghost_pipeline_latest.html" class="dashboard-card">
        <div class="card-icon">üëª</div>
        <div class="card-title">Ghost Pipeline</div>
        <p class="card-description">Track opportunities in the pipeline with extended periods without activity. Monitor alerts sent, response times, and closed-out value to identify and address stalled deals.</p>
        <div class="card-meta">
          <div class="meta-item">Flow ID: 301PQ00000iX6QRYA0</div>
          <span class="status-badge">Active</span>
        </div>
      </a>

      <a href="flow_slack_metrics_past_due_closed_date_latest.html" class="dashboard-card">
        <div class="card-icon">üìÖ</div>
        <div class="card-title">Past Due Closed Date</div>
        <p class="card-description">Monitor opportunities with past due close dates. Track compliance metrics, alert frequency, and response times to ensure timely deal closure.</p>
        <div class="card-meta">
          <div class="meta-item">Flow ID: 301PQ00000iMEFuYAO</div>
          <span class="status-badge">Active</span>
        </div>
      </a>

      <a href="touchpoint_intelligence_latest.html" class="dashboard-card">
        <div class="card-icon">üîç</div>
        <div class="card-title">Touchpoint Intelligence Report</div>
        <p class="card-description">Highlights high-signal accounts (multiple active touchpoints + recent engagement) before opportunities are created. Early-signal detection for proactive pipeline creation.</p>
        <div class="card-meta"><span class="status-badge">Active</span></div>
      </a>
    </div>

    <!-- Footer inside viewport -->
    <div class="footer">
      <div id="runStatus">Ready</div>
      <div class="brandmark">INNOVATIVE ‚Ä¢ SALES OPS</div>
    </div>
  </div>

<script>
  /* ----------------- Configuration ----------------- */
  const CONFIG = {
    endpoints: {
      'refresh-snapshot': '/api/refresh-snapshot',
      'refresh-trailing': '/api/refresh-trailing',
      'slack-aston': '/api/slack-aston',
      'slack-jean': '/api/slack-jean'
    },
    slack: {
      aston: '', // Webhook URL: https://hooks.slack.com/services/YOUR/WEBHOOK/URL
      jean: '',  // Webhook URL: https://hooks.slack.com/services/YOUR/WEBHOOK/URL
      useApi: false,
      botToken: '',  // Slack Bot User OAuth Token (starts with xoxb-)
      userIds: {
        aston: 'U099KHE7XL6',
        jean: 'U073MA5C4MN'
      }
    }
  };

  /* ----------------- Theme ----------------- */
  (function(){
    const themeToggle=document.getElementById('themeToggle');
    const html=document.documentElement;
    const saved=localStorage.getItem('theme')||'light';
    const prefersDark=window.matchMedia('(prefers-color-scheme: dark)').matches;
    const initial=saved==='auto'?(prefersDark?'dark':'light'):saved;
    if(initial==='dark') html.setAttribute('data-theme','dark');
    themeToggle?.addEventListener('click',()=>{
      const dark=html.getAttribute('data-theme')==='dark';
      if(dark){ html.removeAttribute('data-theme'); localStorage.setItem('theme','light'); }
      else{ html.setAttribute('data-theme','dark'); localStorage.setItem('theme','dark'); }
    });
  })();


  /* ----------------- Actions ----------------- */
  const executeButton=document.getElementById('executeButton');
  const runStatus=document.getElementById('runStatus');

  function selectedAction(){ return document.querySelector('input[name="action"]:checked').value; }

  async function triggerRefresh(scriptName, action) {
    const endpoint = CONFIG.endpoints[action];
    if (endpoint && endpoint.startsWith('/api/')) {
      try {
        const response = await fetch(endpoint, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' }
        });
        if (!response.ok) throw new Error(`HTTP ${response.status}`);
        return { success: true, message: `${scriptName} refresh initiated!` };
      } catch (error) {
        return { success: false, message: `API endpoint not configured. For local execution: python3 "${scriptName === 'Snapshot Summary' ? 'SnapshotSummary.py' : 'trailingProfServ.py'}"` };
      }
    }
    return { success: false, message: `To run locally: python3 "${scriptName === 'Snapshot Summary' ? 'SnapshotSummary.py' : 'trailingProfServ.py'}"` };
  }

  async function sendSlackMessage(recipient, webhookUrl) {
    const recipientLower = recipient.toLowerCase();
    if (CONFIG.slack.useApi && CONFIG.slack.botToken && CONFIG.slack.userIds[recipientLower]) {
      return await sendSlackDM(recipient, CONFIG.slack.userIds[recipientLower]);
    }
    if (!webhookUrl || webhookUrl === '') {
      return { success: false, message: `Slack not configured for ${recipient}. Add webhook URL or set useApi=true with botToken.` };
    }
    try {
      const response = await fetch(webhookUrl, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({
          text: `Sales Ops Dashboard refresh requested for ${recipient}`,
          username: 'Sales Ops Bot',
          icon_emoji: ':chart_with_upwards_trend:'
        })
      });
      if (!response.ok) throw new Error(`HTTP ${response.status}`);
      return { success: true, message: `Slack message sent to ${recipient}!` };
    } catch (error) {
      return { success: false, message: `Failed to send Slack message: ${error.message}` };
    }
  }

  async function sendSlackDM(recipient, userId) {
    if (!CONFIG.slack.botToken || !userId) {
      return { success: false, message: `Slack API not configured. Need botToken and userIds.${recipient.toLowerCase()}` };
    }
    try {
      const response = await fetch('/api/slack-dm', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({
          token: CONFIG.slack.botToken,
          userId: userId,
          message: `Sales Ops Dashboard refresh requested for ${recipient}`
        })
      });
      if (!response.ok) throw new Error(`HTTP ${response.status}`);
      return { success: true, message: `Direct message sent to ${recipient}!` };
    } catch (error) {
      return { success: false, message: `Slack API requires a backend endpoint. Create /api/slack-dm that calls Slack's chat.postMessage API. User ID: ${userId}` };
    }
  }

  async function executeAction() {
    const action = selectedAction();
    const button = executeButton;
    button.disabled = true;
    button.classList.add('loading');
    button.textContent = 'Running‚Ä¶';
    runStatus.textContent = `Running: ${action}‚Ä¶`;

    try {
      let result;
      switch(action) {
        case 'refresh-snapshot':
          result = await triggerRefresh('Snapshot Summary', action);
          break;
        case 'refresh-trailing':
          result = await triggerRefresh('6 Week Trailing Report', action);
          break;
        case 'slack-aston':
          result = await sendSlackMessage('Aston', CONFIG.slack.aston);
          break;
        case 'slack-jean':
          result = await sendSlackMessage('Jean', CONFIG.slack.jean);
          break;
        default:
          throw new Error('Unknown action');
      }

      if (result.success) {
        runStatus.textContent = `‚úì ${result.message || 'Completed successfully!'}`;
        runStatus.style.color = 'var(--success)';
      } else {
        runStatus.textContent = `‚úó ${result.message || 'Action failed'}`;
        runStatus.style.color = 'var(--error)';
      }
    } catch (error) {
      runStatus.textContent = `‚úó Error: ${error.message || 'Failed to execute'}`;
      runStatus.style.color = 'var(--error)';
    } finally {
      button.disabled = false;
      button.classList.remove('loading');
      button.textContent = 'Run';
      setTimeout(() => {
        runStatus.textContent = 'Ready';
        runStatus.style.color = 'var(--muted)';
      }, 5000);
    }
  }

  executeButton.addEventListener('click', executeAction);
</script>
</body>
</html>
